<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interview Session | RoleplayAI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .orbitron { font-family: 'Orbitron', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%); position: relative; }
        .grid-overlay {
            background-image: linear-gradient(rgba(99, 102, 241, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(99, 102, 241, 0.1) 1px, transparent 1px);
            background-size: 50px 50px; position: absolute; inset: 0; animation: grid-move 20s linear infinite;
        }
        @keyframes grid-move { 0% { transform: translate(0, 0); } 100% { transform: translate(50px, 50px); } }
        .glass-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .pulse-ring { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes audioBar1 { 0%, 100% { height: 20px; } 50% { height: 60px; } }
        @keyframes audioBar2 { 0%, 100% { height: 40px; } 50% { height: 80px; } }
        @keyframes audioBar3 { 0%, 100% { height: 30px; } 50% { height: 50px; } }
        @keyframes audioBar4 { 0%, 100% { height: 50px; } 50% { height: 70px; } }
        @keyframes audioBar5 { 0%, 100% { height: 35px; } 50% { height: 60px; } }
        .audio-bar-1 { animation: audioBar1 0.8s ease-in-out infinite; }
        .audio-bar-2 { animation: audioBar2 0.7s ease-in-out infinite; }
        .audio-bar-3 { animation: audioBar3 0.9s ease-in-out infinite; }
        .audio-bar-4 { animation: audioBar4 0.6s ease-in-out infinite; }
        .audio-bar-5 { animation: audioBar5 0.75s ease-in-out infinite; }
        .btn-glow-green { box-shadow: 0 0 20px rgba(34, 197, 94, 0.5), 0 0 40px rgba(34, 197, 94, 0.3); }
        .btn-glow-red { box-shadow: 0 0 20px rgba(239, 68, 68, 0.5), 0 0 40px rgba(239, 68, 68, 0.3); }
        .video-container { position: relative; border-radius: 20px; overflow: hidden; background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(168, 85, 247, 0.2)); }
        .avatar-placeholder { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; font-size: 120px; }
    </style>
</head>
<body class="gradient-bg min-h-screen text-white">
    
    <div class="grid-overlay"></div>
    
    <div class="relative z-10">
        
        <header class="pt-6 pb-4">
            <div class="container mx-auto px-6">
                <div class="flex justify-between items-center">
                    <a href="index.html" class="orbitron text-2xl font-bold tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500">‚Üê ROLEPLAYAI</a>
                    <div class="text-sm text-gray-400">Interview Practice Session</div>
                </div>
            </div>
        </header>
        
        <div class="container mx-auto px-6 py-12">
            <div class="max-w-4xl mx-auto">
                
                <div class="text-center mb-8">
                    <h1 class="orbitron text-3xl md:text-4xl font-bold mb-2">INTERVIEW WITH SARAH</h1>
                    <p class="text-gray-400">Senior Tech Recruiter ‚Ä¢ AI-Powered Practice</p>
                </div>
                
                <div class="mb-8">
                    <div class="video-container aspect-video max-w-2xl mx-auto">
                        <div id="avatarPlaceholder" class="avatar-placeholder w-full h-full">üë©‚Äçüíº</div>
                        <div id="activeRing" class="hidden absolute inset-0 border-4 border-blue-400 rounded-2xl pulse-ring"></div>
                    </div>
                </div>
                
                <div class="glass-card rounded-2xl p-8 mb-6 text-center">
                    <div id="statusText" class="text-2xl mb-2 orbitron">Ready to Practice?</div>
                    <div id="subStatusText" class="text-gray-400 text-sm">Click Start Interview to begin your session with Sarah</div>
                </div>
                
                <div class="flex justify-center gap-4 mb-8">
                    <button id="startBtn" class="px-10 py-4 bg-green-600 hover:bg-green-700 text-white font-bold text-lg rounded-xl orbitron btn-glow-green transition-all transform hover:scale-105">‚ñ∂ START INTERVIEW</button>
                    <button id="endBtn" class="hidden px-10 py-4 bg-red-600 hover:bg-red-700 text-white font-bold text-lg rounded-xl orbitron btn-glow-red transition-all transform hover:scale-105">‚ñ† END INTERVIEW</button>
                </div>
                
                <div id="audioVisualizer" class="hidden mb-8">
                    <div class="flex justify-center items-end gap-2 h-20 mb-4">
                        <div class="w-3 bg-blue-500 rounded-full audio-bar-1"></div>
                        <div class="w-3 bg-purple-500 rounded-full audio-bar-2"></div>
                        <div class="w-3 bg-blue-500 rounded-full audio-bar-3"></div>
                        <div class="w-3 bg-purple-500 rounded-full audio-bar-4"></div>
                        <div class="w-3 bg-blue-500 rounded-full audio-bar-5"></div>
                    </div>
                    <p class="text-center text-gray-400 text-sm orbitron">üé§ LISTENING...</p>
                </div>
                
                <div class="glass-card rounded-2xl p-8">
                    <h3 class="orbitron text-xl font-bold mb-4 text-blue-400">üí° INTERVIEW TIPS</h3>
                    <ul class="space-y-3 text-gray-300">
                        <li class="flex items-start gap-3"><span class="text-green-400 mt-1">‚úì</span><span>Use the <strong>STAR method</strong>: Situation, Task, Action, Result</span></li>
                        <li class="flex items-start gap-3"><span class="text-green-400 mt-1">‚úì</span><span>Be <strong>specific</strong> - Sarah will ask for details if you're too vague</span></li>
                        <li class="flex items-start gap-3"><span class="text-green-400 mt-1">‚úì</span><span>Speak <strong>clearly</strong> and at a normal conversational pace</span></li>
                        <li class="flex items-start gap-3"><span class="text-green-400 mt-1">‚úì</span><span>Session lasts <strong>6-7 minutes</strong> - just like a real screening</span></li>
                        <li class="flex items-start gap-3"><span class="text-green-400 mt-1">‚úì</span><span>Your <strong>score will be emailed</strong> after the interview</span></li>
                    </ul>
                </div>
                
            </div>
        </div>
        
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@vapi-ai/web@2.0.5/dist/index.js"></script>
    
    <script>
        (function() {
            'use strict';
            
            const PUBLIC_KEY = 'b6a8e7ba-a59d-4ce4-af73-f0a9b99173d9';
            const ASSISTANT_ID = '763ce219-2778-46f6-ac49-21fd241b4f56';
            
            let vapi = null;
            let callActive = false;
            
            function init() {
                try {
                    vapi = new Vapi(PUBLIC_KEY);
                    console.log('‚úÖ VAPI ready');
                    
                    vapi.on('call-start', () => {
                        console.log('Call started');
                        setUI('active');
                    });
                    
                    vapi.on('call-end', () => {
                        console.log('Call ended');
                        if (callActive) endCall();
                    });
                    
                    vapi.on('speech-start', () => {
                        document.getElementById('subStatusText').innerHTML = 'üé§ Listening...';
                    });
                    
                    vapi.on('speech-end', () => {
                        document.getElementById('subStatusText').innerHTML = '‚è≥ Processing...';
                    });
                    
                    vapi.on('error', (e) => {
                        console.error('VAPI error:', e);
                        setUI('error', e.message);
                    });
                    
                } catch (e) {
                    console.error('Init failed:', e);
                    setUI('error', 'Failed to initialize');
                }
            }
            
            async function startCall() {
                if (!vapi) {
                    setUI('error', 'System not ready');
                    return;
                }
                
                setUI('loading');
                
                try {
                    await vapi.start(ASSISTANT_ID);
                    callActive = true;
                    setUI('active');
                } catch (e) {
                    console.error('Start error:', e);
                    setUI('error', e.message);
                }
            }
            
            function endCall() {
                if (vapi) vapi.stop();
                callActive = false;
                setUI('ending');
                setTimeout(() => {
                    setUI('complete');
                    setTimeout(() => setUI('ready'), 5000);
                }, 2000);
            }
            
            function setUI(state, msg) {
                const status = document.getElementById('statusText');
                const substatus = document.getElementById('subStatusText');
                const startBtn = document.getElementById('startBtn');
                const endBtn = document.getElementById('endBtn');
                const audio = document.getElementById('audioVisualizer');
                const ring = document.getElementById('activeRing');
                
                const hide = (el) => el.classList.add('hidden');
                const show = (el) => el.classList.remove('hidden');
                
                if (state === 'ready') {
                    status.innerHTML = 'Ready to Practice?';
                    substatus.innerHTML = 'Click Start Interview to begin';
                    show(startBtn); hide(endBtn); hide(audio); hide(ring);
                } else if (state === 'loading') {
                    status.innerHTML = 'Connecting...';
                    substatus.innerHTML = 'Please wait';
                    hide(startBtn); show(endBtn); show(audio); show(ring);
                } else if (state === 'active') {
                    status.innerHTML = '<span class="text-green-400">‚óè LIVE</span>';
                    substatus.innerHTML = 'Sarah is ready - start speaking';
                    show(audio); show(ring);
                } else if (state === 'ending') {
                    status.innerHTML = 'Interview Ended';
                    substatus.innerHTML = 'Analyzing...';
                    hide(audio); hide(ring);
                } else if (state === 'complete') {
                    status.innerHTML = '<span class="text-green-400">Complete!</span>';
                    substatus.innerHTML = 'üìä Score will be emailed';
                } else if (state === 'error') {
                    status.innerHTML = '<span class="text-red-400">Error</span>';
                    substatus.innerHTML = msg || 'Please refresh';
                    show(startBtn); hide(endBtn); hide(audio); hide(ring);
                }
            }
            
            document.getElementById('startBtn').onclick = startCall;
            document.getElementById('endBtn').onclick = endCall;
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }
        })();
    </script>
    
</body>
</html>